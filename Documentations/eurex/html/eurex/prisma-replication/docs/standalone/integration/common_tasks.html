<!DOCTYPE HTML>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Common Tasks | Eurex Clearing PME</title>
    <link rel="shortcut icon" href="../../../../../_static/opengamma-favicon.ico"/>
    <link rel="stylesheet" href="../../../../../_static/css/main.css">
    <link rel="stylesheet" href="../../../../../_static/css/syntax.css">
    <link rel="stylesheet" href="../../../../../_static/css/alerts.css">
    <link rel="stylesheet" href="../../../../../_static/font-awesome-4.4.0/css/font-awesome.min.css">
    <script type="text/javascript" src="../../../../../_static/js/jquery-1.11.3.min.js"></script>
    <script type="text/javascript" src="../../../../../_static/js/docs.js"></script>
  </head>
  <body>
    <div class="wrapper">

      <header class="top">
  <div class="row topbar">
    <h1 id="logo" class="logo">
      <a href="../../../../../index.html">Eurex Clearing PME</a>
    </h1>
    <nav>
      <!--
      <ul id="navigation" class="navigation">
        <li><a href="http://www.opengamma.com/opengamma-platform/margining">More</a></li>
      </ul>
      -->
      <div class="og">
        <div class="toggle"><button type="button" id="toggle-menu" class="button--teal">Menu</button></div>
        <div class="og_logo"><a href="http://www.opengamma.com"><img alt="OpenGamma" src="../../../../../_static/logo_topnav.png" /></a></div>
      </div>
    </nav>
  </div>
</header>

      <div id="content" class="row">

        <div id="sidebar" class="sidebar">

          <section>
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../quick_start/toc.html">Quick Start</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../quick_start/set_up_development_environment.html">Setting up a Development Environment</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../quick_start/set_up_development_environment.html#system-requirements">System requirements</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quick_start/set_up_development_environment.html#installation">Installation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../quick_start/run_examples.html">Running the Examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../quick_start/run_examples.html#calculation-of-initial-margin-for-otc-trades">Calculation of Initial Margin for OTC Trades</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quick_start/run_examples.html#calculation-of-initial-margin-for-etd-trades">Calculation of Initial Margin for ETD Trades</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quick_start/run_examples.html#calculation-of-cash-flows">Calculation of Cash Flows</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quick_start/run_examples.html#basic-api-integration-example">Basic API Integration Example</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quick_start/run_examples.html#running-from-the-command-line">Running from the Command Line</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../quick_start/basic_library_integration.html">Basic Library Integration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../quick_start/basic_library_integration.html#margin-environment-lifecycle">Margin Environment Lifecycle</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quick_start/basic_library_integration.html#data-lifecycle">Data Lifecycle</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quick_start/basic_library_integration.html#third-party-libraries">Third-Party Libraries</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../quick_start/advanced_library_integration.html">Advanced Library Integration</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../overview/toc.html">Overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../common/overview/features.html">Features</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../common/overview/features.html#margin-methodologies">Margin Methodologies</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../common/overview/features.html#product-scope">Product Scope</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../common/overview/features.html#outputs">Outputs</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../overview/system_requirements.html">System Requirements</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../overview/system_requirements.html#software">Software</a></li>
<li class="toctree-l3"><a class="reference internal" href="../overview/system_requirements.html#hardware">Hardware</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../overview/release_notes.html">Release Notes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../common/overview/known_limitations.html">Known Limitations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../common/overview/known_limitations.html#general">General</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../common/overview/known_limitations.html#etd">ETD</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../common/overview/known_limitations.html#otc">OTC</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../overview/faq.html">Frequently Asked Questions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../overview/faq.html#system-requirements">System Requirements</a></li>
<li class="toctree-l3"><a class="reference internal" href="../overview/faq.html#market-data">Market Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../overview/faq.html#trades-and-positions">Trades and Positions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../overview/faq.html#margin-calculation">Margin Calculation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../data/toc.html">Input Data</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../data/trade_parsers.html">Portfolio</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../common/trade_parsers/eurex_etd_csv.html">Eurex ETD CSV</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../common/trade_parsers/eurex_otc_csv.html">Eurex OTC CSV</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../common/trade_parsers/eurex_sensitivities_csv.html">Eurex Sensitivities CSV</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../common/trade_parsers/fpml.html">FpML</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../common/trade_parsers/fixml.html">FIXML</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../common/data/eurex_market_data.html">Market Data</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../common/data/eurex_market_data.html#otc-requirements">OTC Requirements</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../common/data/eurex_market_data.html#etd-requirements">ETD Requirements</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../common/data/eurex_market_data.html#cross-margining-requirements">Cross-Margining Requirements</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../common/data/fixings.html">Fixings</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../common/data/fixings.html#format">Format</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../common/data/fixings.html#api">API</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../common/data/holidays.html">Holidays</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../common/data/holidays.html#format">Format</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../common/data/holidays.html#api">API</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../common/data/standard_directory_structure.html">Standard Directory Structure</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../common/data/standard_directory_structure.html#directory-layout">Directory Layout</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../common/data/standard_directory_structure.html#individual-file-conventions">Individual File Conventions</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="toc.html">Integration</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="architecture.html">Library Architecture</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../common/api/loading_market_data.html">Loading Market Data</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../common/api/loading_market_data.html#automatic-file-resolution">Automatic file resolution</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../common/api/loading_market_data.html#explicit-usage">Explicit usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../common/api/loading_market_data.html#error-handling-during-loading">Error handling during loading</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../common/api/loading_portfolios.html">Loading Portfolios</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../common/api/loading_portfolios.html#error-handling-during-loading">Error handling during loading</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../common/api/performing_calculations.html">Performing Calculations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../common/api/performing_calculations.html#trade-requests">Trade Requests</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../common/api/performing_calculations.html#portfolio-requests">Portfolio Requests</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../common/api/performing_calculations.html#add-ons">Add-ons</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../common/api/performing_calculations.html#portfolio-im">Portfolio IM</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../common/api/performing_calculations.html#building-a-request">Building a request</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../common/api/performing_calculations.html#p-l-calculation-methodology">P&amp;L calculation methodology</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../common/api/performing_calculations.html#output-model">Output Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../common/api/performing_calculations.html#error-handling-during-calculation">Error handling during calculation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../common/overview/calculation_modes.html">Calculation Modes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../common/overview/calculation_modes.html#full-revaluation">Full Revaluation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../common/overview/calculation_modes.html#delta-approximation">Delta Approximation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="margin_results.html">Margin Results</a><ul>
<li class="toctree-l3"><a class="reference internal" href="margin_results.html#portfolio-results">Portfolio Results</a></li>
<li class="toctree-l3"><a class="reference internal" href="margin_results.html#trade-results">Trade Results</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="concurrency.html">Concurrency</a><ul>
<li class="toctree-l3"><a class="reference internal" href="concurrency.html#cpu-utilization">CPU utilization</a></li>
<li class="toctree-l3"><a class="reference internal" href="concurrency.html#custom-executor-service">Custom Executor Service</a></li>
<li class="toctree-l3"><a class="reference internal" href="concurrency.html#concurrent-use-of-the-api">Concurrent use of the API</a></li>
</ul>
</li>
<li class="toctree-l2 current"><a class="current reference internal" href="">Common Tasks</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#what-if-analysis">What-If Analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="#multiple-days-of-market-data">Multiple Days of Market Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="#log-configuration">Log Configuration</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../advanced/toc.html">Advanced Topics</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../advanced/trade_model.html">Trade Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../advanced/third_party_dependencies.html">Third-Party Dependencies</a></li>
</ul>
</li>
</ul>

            
          </section>
        </div>

        <main id="main" class="main">
          
  <div class="section" id="common-tasks">
<h1>Common Tasks</h1>
<p>This page organizes several common use cases in incorporating the Eurex Clearing PME into your
applications.</p>
<div class="section" id="what-if-analysis">
<h2>What-If Analysis</h2>
<p>It is expected that the Eurex Clearing PME will be used for what-if analysis, looking at
the impact of adding new trades to the cleared portfolio. To achieve this will require a
single <code class="docutils literal"><span class="pre">MarginEnvironment</span></code> with a single <code class="docutils literal"><span class="pre">MarginData</span></code> populated with the previous day&#8217;s
end of day data. Whether this is OTC or ETD or both will depend on the portfolios you are
interested in.</p>
<p>You will also require a <code class="docutils literal"><span class="pre">MarginCalculator</span></code> to process requests. When conducting what-if
analysis it is usual that performance is a key requirement. Therefore using the
<a class="reference internal" href="../../common/overview/calculation_modes.html#delta-approximation"><span>Delta Approximation</span></a> mode should be considered. It is also
more efficient if the base portfolio is provided as a <a class="reference internal" href="../../common/trade_parsers/eurex_sensitivities_csv.html#eurex-sensitivities-csv"><span>Eurex Sensitivities CSV</span></a>.</p>
<p>To perform what-if analysis you will need to do the following:</p>
<ol class="arabic simple">
<li>Ensure you a a <code class="docutils literal"><span class="pre">MarginEnvironment</span></code> available with the required market data</li>
<li>Calculate margin on the base portfolio</li>
<li>Calculate margin on the proposed new portfolio i.e. the base portfolio plus any new trades
(see <a class="reference internal" href="../../common/api/loading_portfolios.html#loading-portfolios"><span>Loading Portfolios</span></a> for how to create portfolios containing trades
from different sources)</li>
<li>Gather the results from each of these margin runs and calculate the incremental impact
of adding the new trades to the base portfolio</li>
</ol>
</div>
<div class="section" id="multiple-days-of-market-data">
<h2>Multiple Days of Market Data</h2>
<p>In a default use case, the expected use of the Eurex Clearing PME has a single <code class="docutils literal"><span class="pre">MarginEnvironment</span></code>, with
a single <code class="docutils literal"><span class="pre">MarginData</span></code>, typically configured with the previous day&#8217;s end of day, which has
a single <code class="docutils literal"><span class="pre">MarginCalculator</span></code> to process requests. However, while our examples only load in a single
day&#8217;s worth of data, it is entirely possible to have multiple days worth of data simultaneously loaded.</p>
<p>In this way, the calculation requests, which specify the valuation date, are keyed to the right
data in the <code class="docutils literal"><span class="pre">MarginData</span></code> structure. It is not possible out-of-the-box to issue calculation requests for a
date for which there is no data in the <code class="docutils literal"><span class="pre">MarginData</span></code> structure (so you cannot have a valuation
date of tomorrow when there is only market data loaded for today).</p>
<p>Configuring in this way will result in the <code class="docutils literal"><span class="pre">MarginEnvironment</span></code> having one thread pool, and thus
having better concurrency operation than constructing multiple <code class="docutils literal"><span class="pre">MarginEnvironment</span></code> s.
However, each day&#8217;s worth of data has significant RAM overhead, and needs to be taken into
account when doing capacity planning.</p>
<p>Please bear in mind when designing for multi-day use case that you cannot remove historical data
from a <code class="docutils literal"><span class="pre">MarginData</span></code> structure. If you do not have sufficient heap to support all historical
data at once, you must design in the following pattern:</p>
<p>First, create your own <code class="docutils literal"><span class="pre">ExecutorService</span></code>. (see <a class="reference internal" href="concurrency.html#concurrency"><span>Concurrency</span></a>)</p>
<p>For each day of analysis required:</p>
<ol class="arabic simple">
<li>Create a <code class="docutils literal"><span class="pre">MarginEnvironment</span></code>, using the shared <code class="docutils literal"><span class="pre">ExecutorService</span></code></li>
<li>Load in the market data for the day in question</li>
<li>Perform necessary calculations and gather results</li>
<li>Allow that <code class="docutils literal"><span class="pre">MarginEnvironment</span></code> to fall out of scope so that all market data resources can be garbage collected.</li>
</ol>
</div>
<div class="section" id="log-configuration">
<h2>Log Configuration</h2>
<p>The Eurex Clearing PME uses <a class="reference external" href="http://www.slf4j.org/">SLF4J</a> , as do many of the third-party
libraries used by the PME. All log notifications generated by the PME itself (as opposed to
third-party underlying libraries) have a log context starting with <code class="docutils literal"><span class="pre">com.opengamma.</span></code></p>
</div>
</div>


        </main>
      </div>

      <footer>
  <div class="row">
    <div class="small-6 columns"><p>Version 1.8.3</p></div>
    <div class="small-6 columns"><p class="copyright">&copy; 2015 OpenGamma Limited</p></div>
  </div>
</footer>
    </div>
  </body>
</html>
